Дополнение к ранжированию
При рассмотрении различных ситуаций, связанных с извлечением экспертных знаний, возникает потребность каким-либо упорядочить все множество оценок, затрагивая уже понятие группового ранжирования. Положим, имеется конечное множество объектов (например, экспертных оценок или критериев) и экспертов, пронумерованных индексами . Каждый й эксперт выставляет рейтинг, порождая порядок. Подобные тип задач в машинном обучении обозначается как ранжирование.
Ранжирование (англ. learning to rank) — особый тип задач машиного обучения , связанный с постороением некой ранжирующей модели по обучащей выборке. Отличие от классификации и регрессии состоит в том, что для обучающей выборки не заданы ответы, однако задано отношение порядка для пары объектов. Стоит отметить, что от отношения порядка на множестве объектов изменяется и подход к ранжированию.
Содержание
- 1 Слабое ранжирование.Представления
- 2 Частичное ранжирование
- 3 Сильное ранжирование
- 4 Supervised алгоритмы ранжирования
- 5 Примечания
- 6 Источники информации
Слабое ранжирование.Представления
Строгое слабое упорядовачивание
|Определение:
|Бинарное отношение на множестве , которое является частично упорядоченным, называется слабым упорядочиванием (англ. weak ordering), если оно обладает следующими свойствами:
Рассмотрим случаи, определеяющее частичное упорядочение как:
- Сильное: и , то есть если ~ .
- Слабое[1]: если , то и .
Можно заключить, что любое cильное упорядовачивание есть слабое. Отношение несравнимости является отношением эквивалентности для всех своих разбиений на множестве , что являются линейно упорядоченными.
Сильный подпорядок
|Определение:
|Сильный подпорядок — такой подпорядок, на котором присутствует отношение связанности.
Сильный подпорядокобладает рядом следующих свойств:
- Транзитивность: если и .
- Связанности: выполнимо либо , либо .
Если в любом сильном подпорядке отношение эквивалентности. Поскольку операция определена для всех элементов, такие подпорядки еще называют отношением предпочтения[2].и , то на нем определено
Сравнения
Вещественная функция
Удобство использования слабого ранжирования в том, что его элементы могут быть представлены единственным образом с помощью вещественных функций. Рассмотрим следующую теорему.
|Теорема:
Для любого частичного упорядочиванияслабое тогда и только тогда, когда существует и отображение если , то и наоборот.
Таким образом, чтобы имели место быть:
- частичный подпорядок: для тогда и только тогда, когда .
- эквивалентность: для тогда и только тогда, когда .
Ограничения:
Лексикографические предпочтения. Ранжирующая функция может быть определена на любом конечном множестве, однако для случая лексикографического порядка функция не определена на .
Инъективность. В случае, если бы являлась бы инъективной функцией, то класс эквивалентности двух элементов множества мог бы переходить в более широкий соответствующий класс на множестве .
Сюрьективность. Если на вводятся ограничения, чтобы быть сюръективной функцией, то при отображении элементов некого класса на возможно соответствие ему меньшего или вовсе пустого класса на .
Кусочная последовательность
Для любого конечного множества, на котором задано отношение слабого упорядовачивания и , может быть применимо моделирование с помощью кусочных последовательностей. Рассмотрим пример. Положим, что
Тогда слабое ранжированиепредставляется в виде следующего:
Частичное ранжирование
|Определение:
|Бинарное отношение на множестве , для некоторых элементов которого определена несравнимость ,называется частичным упорядочиванием (англ. semiorder), если оно обладает следующими свойствами:
Сравнения
Вещественная функция
Частичное ранжирование поддается тому же функциональному подходу к сравнению за тем лишь исключением, что для численных значений объектов вводится некоторая погрешность, внутри которой объекты считаются сравнимы, снаружи - нет. Зачастую такую погрешность выбирают нормированной к .
|Теорема:
Для любого конечного частичного упорядочиваниемвозможно определить такое и функционал если , то и наоборот.
Интервальный метод
Имея заданный функционали возможно использование интервального сравнения, а именно — объекты считаются сравнимы, если значения их оценок лежат в некотором интервале. Так, например, если , то .
Ограничения:
Если у данного частичного ранжирования существует несчетное множество строго упорядоченных объектов, то невозможно подобрать такую. В противовес, любое конечное частичное ранжирование может быть описано с помощью .
Сильное ранжирование
|Определение:
|Бинарное отношение на множестве , для некоторых элементов которого определена несравнимость ,называется сильным ранжированием (англ. total order), если оно обладает следующими свойствами:
Таким образом, сильное ранжирование — строгое слабое, для которого.
Сравнения
Вещественная функция
Сильное ранжирование сравнивается с помощью функционала.
|Лемма:
Для любого конечного сильного упорядочиваниявозможно определить такой функционал если , то и наоборот.
Последовательность
Для любого конечного множества, на котором задано отношение сильного упорядочивания и , может быть применимо моделирование с помощью порождения последовательности значений элементов. Иными словами, задается новый функционал , что все оценки образуют последовательность.
Ограничения:
Как и для частичного, множество должно быть конечно.
Supervised алгоритмы ранжирования
OC-SVM
Ordinal Classification SVM — алгоритм поточечного ранжирования, рассматривающий каждый объект обособленно. В основе стоит использования идеи метода опорных векторов о проведении разделяющей гиперплоскости над множеством оценок.
Постановка задачиПусть имеется некое число градаций (оценок, предпочтений) , тогда — ранжирующая функция с порогами
Основное отличие от классического подхода в том, что на имеющееся рисунке 1.границ необходимо найти зазоров. Иными словами, необходимо найти один направляющий вектор числа гиперплоскостей. Исходим от предположения, что найдется такое направление, в котором объекты удовлетворительно отранжировались. Пример такого разделения для представлен на
Подход
Поскольку теперь увеличилось число зазоров, классического значения штрафанедостаточно — необходимы штрафы и для нарушение с левой и правой сторон соответственно ой границы. Ограничительное условие для такого случая состоит в том, что произвольный объект , оказавшийся между разделяющими полосами, не должен выйти за их пределы ни слева, ни справа, что можно записать как:
Для случая крайних границ, для объектовможет существовать только нарушение слева от границы, когда для объектов — только справа от границы. Таким образом, задача может быть сформирована как задача минимизации с ограничениями:
Ranking SVM
Алгоритм для попарного подхода[3] к ранжированию. Основное отличие от алгоритма SVM в том, что теперь объекты нумеруются попарно.
Постановка задачи
Считаем, что теперь решаем следующую оптимизационную задачу:
Подход
Поскольку теперь все операции выполяняются уже для пары объектов, то строгая система ограничений будет отличаться в соответствующих местах:
RankNet, LambdaRank
Данные алгоритмы применяются для списочного ранжирования, хотя по сути своей используют попарный подход, который был расширен до случая списка.
Постановка задачи
Считаем, что у нас есть некий гладкий функционал качества, который необходимо оптимизировать:
Конкретную функцию потерь в оригинальной работе[4] выбирают как логистическую функцию потерь, те
масштабирующий параметр для пересчета значения отступа в вероятностное значение.
Подход
Воспользовавшись методом стохастического градиентного спуска, выбираем на каждойой итерации случайным образом запрос и пару документов из запроса , получаем итеративную формулу вычисления весов:
Чтобы перейти к использованию негладких функционалов MAP, NDCD, pFound необходимо домножить рисунке 2.на изменение данного функционала при перестановке местами и в каждой итерации. Это означает, как изменится веса модели, если в задаче ранжирования поменять местами два документа. Результаты оценки алгоритма с разным функционалом представлены на
LambdaRank моделирует следующий итеративный процесс:
Оптмизируется тем самым по функционалу NDCD.
SoftRank
SoftRank — списочный метод ранжирования, который предполагает использовать сглаживание[5] для возможности диффиренцирования значения сложной метрики.
Постановка задачи
Сперва необходимо перейти от поиска изначально детерминированного положения документа в отранижрованном порядке к случайной величине, распределенной по нормальному закону так, чтобы центр распределения лежал в предсказании функции ранжирования, как представлено на рисунке 3. Величина дисперсии теперь также параметр модели:
Возможно оценить вероятность того, что некий документй окажется выше го.
Теперь задача формулируется следующим образом: оценить вероятность того, чтой документ окажется на позиции .
Подход
Вычисления происходят рекурсивно для каждого
. Оценить вероятность оказаться на м месте для элемента:
. Тогда вероятность оказаться на м и м месте для двух документов:
. Для выборки из х элементов, вероятность оказаться на первом месте:
и т.д.
Графическая интерпритация вычислительного процесса представлена на рисунке 4.
Чтобы использовать метрику NDCG необходимо учесть математическое ожидание ассесорской оценки , что уже дает гладкий функционал:
Данное выражения уже возможно оптимизировать градиентом:
вычислятся через :